# SQL

## 关系模型

表的每一行称为记录（Record）（有多个字段组成），记录是一个逻辑意义上的数据。

表的每一列称为字段（Column），同一个表的每一行记录都拥有相同的若干字段。

字段定义了数据类型（整型、浮点型、字符串、日期等），以及是否允许为`NULL`。注意`NULL`表示字段数据不存在。一个整型字段如果为`NULL`不表示它的值为`0`，同样的，一个字符串型字段为`NULL`也不表示它的值为空串`''`。

**通常情况下，字段应该避免允许为NULL。不允许为NULL可以简化查询条件，加快查询速度，也利于应用程序读取数据后无需判断是否为NULL。**

###### 班级表

| ID   | 名称       | 班主任 |
| ---- | ---------- | ------ |
| 201  | 二年级一班 | A1     |
| 202  | 二年级二班 | A3     |

###### 学生表

| ID   | 姓名 | 班级ID | 性别 | 年龄 |
| ---- | ---- | ------ | ---- | ---- |
| 1    | 小明 | 201    | M    | 9    |
| 2    | 小红 | 202    | F    | 8    |
| 3    | 小军 | 202    | M    | 8    |
| 4    | 小白 | 201    | F    | 9    |

###### 教师表

| ID   | 名称   | 年龄 |
| ---- | ------ | ---- |
| A1   | 王老师 | 26   |
| A2   | 张老师 | 39   |
| A3   | 李老师 | 32   |
| A4   | 赵老师 | 27   |

一对多：一个班级对应多个学生，班级表和学生表的关系就是“一对多”。

多对一：多个学生对应一个班级，学生表和班级表是“多对一”的关系。

一对一：一个班级对应一个教师，班级表和教师表就是“一对一”关系。

### 主键

对于关系表，有个很重要的约束，就是任意两条记录不能重复。不能重复不是指两条记录不完全相同，而是指能够通过某个字段唯一区分出不同的记录，这个字段被称为*主键*。

**对主键的要求，最关键的一点是：记录一旦插入到表中，主键最好不要再修改，因为主键是用来唯一定位记录的，修改了主键，会造成一系列的影响，主键也不应该是NULL。**

**选取主键的一个基本原则是：不使用任何业务相关的字段作为主键。**

身份证号、手机号、邮箱地址这些看上去可以唯一的字段，均*不可*用作主键。

因此可以用自增整数类型，`BIGINT NOT NULL AUTO_INCREMENT`类型。

**如果使用INT自增类型，那么当一张表的记录数超过2147483647（约21亿）时，会达到上限而出错。使用BIGINT自增类型则可以最多约922亿亿条记录。**

#### 联合主键

一个表里面可以有两个主键，最好不用，关系表的复杂度上升。

### 外键

